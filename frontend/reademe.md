

# 电影直播间 + 数据看板前端项目

## 项目简介

本项目实现了一个基于 WebSocket 和 Kafka 实时数据流的**电影直播互动页面**，集成了直播视频播放、弹幕互动、点赞动画、礼物展示和实时数据看板等功能。支持多人在线互动、实时统计及动态 UI 效果，适合做直播间、互动社区和数据可视化场景。

---

## 功能亮点

* **视频播放**：支持播放视频流，带播放/暂停按钮和进度条控制。
* **实时弹幕评论**：用户可发送评论，评论以动画形式滚动展示。
* **点赞动画**：点击点赞按钮，屏幕右下角出现漂浮心形动画。
* **礼物展示**：礼物发送时，屏幕顶部显示礼物横幅动画。
* **用户加入提示**：用户进入直播间时，屏幕弹出提示消息。
* **WebSocket 实时交互**：所有交互事件通过 WebSocket 同步服务器和其他用户。
* **实时数据看板**：统计在线人数、累计点赞数、评论数、礼物价值、播放时长等核心指标。
* **响应式设计**：适配不同屏幕尺寸，基于 Tailwind CSS 快速构建美观界面。

---

## 技术栈

* **HTML5 & CSS3**（Tailwind CSS）
* **JavaScript**（原生 JS WebSocket API）
* **Google Fonts**（Noto Sans SC）
* **动画效果**：CSS3 动画关键帧（@keyframes）
* **视频播放器**：原生 `<video>` 标签播放，支持播放控制和时间进度显示

---

## 项目结构简述

* **index.html**（本文件）

    * 包含页面所有 UI 结构、样式和前端业务逻辑脚本
    * 核心元素：

        * `<video>` 视频播放器区域
        * 弹幕评论区、点赞动画容器、礼物横幅区域
        * 实时数据看板区域
        * 评论输入框弹出层
    * JavaScript 部分实现 WebSocket 连接、事件发送与接收、UI 动态更新、视频播放控制等功能

---

## 快速运行

1. **部署后端服务**

    * 请确保有支持 WebSocket 和 Kafka 后端服务在 `ws://localhost:8080/ws` 和 `ws://localhost:8080/stats-ws` 正常运行
    * Kafka 服务地址及端口根据后端配置进行调整

2. **启动前端**

    * 将本 `index.html` 文件放入静态服务器或本地直接打开
    * 页面自动连接 WebSocket 并开始实时交互

3. **测试交互**

    * 点击点赞、发送评论、送礼物按钮，观察页面动画效果和数据看板变化
    * 多个浏览器窗口打开，可测试多用户实时互动

---

## 配置说明

* **WebSocket 地址**

    * 当前硬编码为 `ws://localhost:8080/ws` 和 `ws://localhost:8080/stats-ws`
    * 生产环境建议替换为真实后端地址，支持配置环境变量或动态注入

* **用户ID**

    * 每次页面随机生成唯一用户ID，用于区分不同用户事件
    * 可改为后端鉴权后传入的用户唯一标识

* **视频源**

    * 默认示例视频地址：

      ```
      http://commondatastorage.googleapis.com/gtv-videos-bucket/sample/Sintel.mp4
      ```
    * 可替换为任意支持跨域的视频流地址

---

## 代码重点说明

* **WebSocket 事件类型**

    * `user_join`：新用户加入通知
    * `comment`：弹幕评论
    * `like`：点赞动画触发
    * `send_gift`：礼物发送展示

* **UI 动画**

    * 使用 CSS 关键帧实现心形漂浮、弹幕滑入、礼物横幅和用户加入提示动画
    * 动画元素动态创建和销毁，保证页面流畅

* **数据看板**

    * 统计数据通过第二个 WebSocket 连接实时接收
    * 在线人数使用 Set 结构去重
    * 直播时长根据页面打开时间计算

* **视频控制**

    * 点击覆盖层或播放按钮开始播放
    * 支持暂停、播放切换和进度条跳转

---

## 未来改进建议

* **支持多房间和多频道切换**
* **视频播放兼容性增强，支持 HLS/DASH 流**
* **完善用户身份验证和权限管理**
* **引入前端框架（React/Vue）提升可维护性**
* **增加更多互动类型（投票、问答等）**
* **接入 CDN 和缓存优化提升性能**
* **响应式和无障碍优化**

---

## 常见问题

* **WebSocket 连接失败**

    * 确认后端 WebSocket 服务启动并允许跨域连接
    * 检查浏览器控制台报错信息，确认地址端口无误

* **视频无法播放**

    * 视频地址必须支持跨域访问
    * 浏览器限制自动播放，尝试手动点击播放按钮

* **动画卡顿**

    * 确认设备性能和浏览器支持 CSS3 动画
    * 优化动画频率和 DOM 操作次数

---
